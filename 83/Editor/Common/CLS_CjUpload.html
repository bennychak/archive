<body bgcolor="#ededed">
<pre style="background-color:#FFFFFF;">
=============================================================================================

 Chris.J ASP Upload Script v2.2

 程序制作: 黄嘉隆(Chris.J)

 联系方式:
           E-mail:phoubes@hotmail.com
           MSN:   phoubes@hotmail.com
           Web:   phoubes.51.net
 版权声明:                         

         本软体为共享软体(ShareWare)仅供个人学习与参考,
     版权归属作者个人所有,任何单位及个人未经作者书面授权
     许可,不得将之用于盈利或非盈利性的商业用途。
         为能够适应实际的应用情况,可以对本软件进行必要的
     修改,但必须通知作者并保留本版权声明。

                                            2004年8月1日
                                                              
=============================================================================================
</pre>
<pre>
    详细操作请参考Sample

=============================================================================================
what's news v2.2

	1.将2.1 版本的默认限制"不允许上传ASP文件",修改成 "允许上传任何格式的文件"
	2.增加了LimitExt = "*" (任何格式的文件) 
		当LimitExt = "*" , LimitExtMode = "allow" : "<strong>允许上传任何格式的文件</strong>"
		当LimitExt = "*" , LimitExtMode = "deny"  : "<strong>不允许上传任何格式的文件</strong>"

=============================================================================================
what's news v2.1
    
    1.修改同名表单项目的值保存方式.
    2.增加文件大小的控制.
    3.增加文件格式的约束(两种模式).
    4.增加了文件类的Binary属性(该属性可获得上传文件的二进制流,可单独保存于数据库).
    5.增加了文件类的SaveAs方法.
    6.修改了默认的保存路径为执行脚本的物理路径.
    

=============================================================================================
what's news v2.0

	.....

=============================================================================================
主要属性说明:

	Path         : (读/写)上传文件的保存路径(绝对物理路径)
	
	LimitExt     : (读/写)上传文件后缀的约束
	
					默认为 "*"(星号) : 指任何格式的文件
					其他的格式集合如:   GIF|JPG|BMP  (以"|"来分隔不同的格式)
	
	LimitExtMode : (读/写)上传文件后缀的约束模式
					
					默认为 "allow" : 指"允许上传",配合 LimitExt = "*" ,说明"允许上传任何格式的文件".
					属性值有:					

					"deny" 或 "0" 或 0    : 指"允许上传"					
					"allow" 或 "1" 或 1   : 指"允许上传"
	
	MaxBytes     : (读/写)上传文件大小的约束(结束属性,单位Byte)
	
					默认为 -1 :指不限制上传文件的大小



=============================================================================================
主类(CJUpload)的属性与方法:

属性:
	
    //
	
	Version             : 版本号
	TotalBytes          : 本次提交表单总字节
	Count               : 本次提交表单的表单项目总数
	Form                : 上传表单项目的集合("Scripting.Dictionary"对象)
	File                : 上传文件项目的集合("Scripting.Dictionary"对象)
	
    //统一设置的属性(<strong><font color=red>其他文件的相关属性也跟着改变</font></strong>)
    
	Path                : (读/写) 上传文件的保存路径(绝对物理路径)

	LimitExt            : (读/写) 上传文件后缀的约束设置(结束属性,字符形式以"|"分隔如: LimitExt="ASP|PHP|EXE"

	LimitExtMode        : (读/写) 上传文件后缀的约束模式(结束属性,"allow" 或 "1" 为允许约束 , "deny" 或 "0" 为不允许约束 )

	MaxBytes            : (读/写) 上传文件大小的约束(结束属性,单位Byte)

   错误属性
    
	Err                 : 错误代码
	Description         : 错误说明

方法:
	ClearError()        : 清除错误


=============================================================================================
文件类(CJFile)的属性与方法:

属性:

	Path                : (读/写) 上传文件的保存路径
	LimitExt            : (读/写) 上传文件后缀的约束设置(约束属性,字符形式以"|"分隔如: LimitExt="ASP|PHP|EXE")
	LimitExtMode        : (读/写) 上传文件后缀的约束模式(约束属性,"allow" 或 "1" 为允许上传,"deny" 或 "0" 为不允许上传 )
	MaxBytes            : (读/写) 上传文件大小的约束(约束属性,单位Byte)
	
	Binary              : (只读) 上传文件的二进制流(可保存于数据库)
	FormItem            : (只读) 该文件的表单项目名称
	UserFileName        : (只读) 用户本地文件名
	ContentType         : (只读) 数据的内容型态
	TotalBytes          : (只读) 文件大小
	FileName            : (读/写) 文件名,默认为上传文件名,可根据需要修改.
	FileExt             : (只读) 文件后缀(不带".")
	
	
    错误属性
    
	Err                 : 错误代码
	Description         : 错误说明

方法:

	IsValid()           : (返回值true/false)依据约束属性的设置校验上传文件的正确性(包括文件大小与文件后缀的校验,详细请					查看Sample)

	CheckFileSize()     : (返回值true/false)依据文件大小的约束属性校验上传文件的大小(只包括文件大小的校验)

	ClearError()        : 清除错误

	Save()              : 依据Path与fileName属性直接保存文件

	SaveAs(v)           : 另存为(参数请输入完整物理地址及文件名)
	
=============================================================================================
Error 代码与提示

-1   : 正常

100  : 提交表单的MIME编码非multipart/form-data类型.

200  : 上传的文件过大.

300  : 上传的文件格式不支持.

400  : 上传文件格式为禁止的文件格式.

500  : 未设置文件后缀的校验模式.

600  : 无上传文件.

700  : 上传的文件为空文件

800  : 禁止上传任何文件



</pre>
</body>